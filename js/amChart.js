let data = [{"id":1,"Country":"Azerbaijan","Patient Count":90,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":2,"Country":"Colombia","Patient Count":85,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":3,"Country":"Nigeria","Patient Count":83,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":4,"Country":"Serbia","Patient Count":51,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":5,"Country":"Greece","Patient Count":49,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":6,"Country":"Syria","Patient Count":15,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":7,"Country":"Portugal","Patient Count":52,"Out of Scope":false,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":8,"Country":"China","Patient Count":69,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":9,"Country":"France","Patient Count":65,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":10,"Country":"Philippines","Patient Count":69,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":11,"Country":"Brazil","Patient Count":40,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":12,"Country":"Peru","Patient Count":86,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":13,"Country":"China","Patient Count":93,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":14,"Country":"Russia","Patient Count":72,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":15,"Country":"China","Patient Count":76,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":16,"Country":"Canada","Patient Count":9,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":17,"Country":"Poland","Patient Count":45,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":18,"Country":"Russia","Patient Count":51,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":19,"Country":"Palestinian Territory","Patient Count":61,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":20,"Country":"Micronesia","Patient Count":82,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":21,"Country":"Ireland","Patient Count":48,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":22,"Country":"Iran","Patient Count":51,"Out of Scope":false,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":23,"Country":"Vietnam","Patient Count":59,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":24,"Country":"Philippines","Patient Count":67,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":25,"Country":"Brazil","Patient Count":62,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":26,"Country":"Portugal","Patient Count":67,"Out of Scope":true,"No Issue":true,"Not Started ":true,"Problematic":true},
{"id":27,"Country":"Indonesia","Patient Count":98,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":28,"Country":"China","Patient Count":18,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":29,"Country":"Chad","Patient Count":6,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":30,"Country":"France","Patient Count":98,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":31,"Country":"South Korea","Patient Count":13,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":32,"Country":"Colombia","Patient Count":70,"Out of Scope":false,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":33,"Country":"Yemen","Patient Count":14,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":34,"Country":"China","Patient Count":55,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":35,"Country":"China","Patient Count":41,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":36,"Country":"Indonesia","Patient Count":20,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":37,"Country":"Sierra Leone","Patient Count":96,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":38,"Country":"Hungary","Patient Count":5,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":39,"Country":"China","Patient Count":49,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":40,"Country":"Colombia","Patient Count":83,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":41,"Country":"China","Patient Count":25,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":42,"Country":"Nigeria","Patient Count":67,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":43,"Country":"Malawi","Patient Count":17,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":44,"Country":"Albania","Patient Count":43,"Out of Scope":false,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":45,"Country":"Colombia","Patient Count":32,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":46,"Country":"China","Patient Count":9,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":47,"Country":"Portugal","Patient Count":40,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":48,"Country":"Afghanistan","Patient Count":87,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":49,"Country":"Philippines","Patient Count":52,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":50,"Country":"Hong Kong","Patient Count":3,"Out of Scope":true,"No Issue":true,"Not Started ":true,"Problematic":true},
{"id":51,"Country":"Nigeria","Patient Count":88,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":52,"Country":"Philippines","Patient Count":47,"Out of Scope":false,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":53,"Country":"Russia","Patient Count":22,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":54,"Country":"Russia","Patient Count":79,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":55,"Country":"Luxembourg","Patient Count":42,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":56,"Country":"Iraq","Patient Count":12,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":57,"Country":"Portugal","Patient Count":100,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":58,"Country":"United States","Patient Count":71,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":59,"Country":"Philippines","Patient Count":19,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":60,"Country":"Netherlands","Patient Count":30,"Out of Scope":true,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":61,"Country":"Argentina","Patient Count":41,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":62,"Country":"United States","Patient Count":31,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":63,"Country":"Bulgaria","Patient Count":63,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":64,"Country":"Indonesia","Patient Count":69,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":65,"Country":"China","Patient Count":89,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":66,"Country":"Brazil","Patient Count":63,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":67,"Country":"China","Patient Count":12,"Out of Scope":true,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":68,"Country":"Peru","Patient Count":53,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":69,"Country":"Sweden","Patient Count":82,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":70,"Country":"Indonesia","Patient Count":21,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":71,"Country":"Malaysia","Patient Count":77,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":72,"Country":"Indonesia","Patient Count":91,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":73,"Country":"Peru","Patient Count":39,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":74,"Country":"Japan","Patient Count":97,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":75,"Country":"Greece","Patient Count":28,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":76,"Country":"Croatia","Patient Count":44,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":77,"Country":"Greece","Patient Count":60,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":78,"Country":"Indonesia","Patient Count":14,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":79,"Country":"Serbia","Patient Count":44,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":80,"Country":"Peru","Patient Count":87,"Out of Scope":false,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":81,"Country":"Russia","Patient Count":28,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":82,"Country":"Portugal","Patient Count":17,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":83,"Country":"Indonesia","Patient Count":58,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":true},
{"id":84,"Country":"Vietnam","Patient Count":40,"Out of Scope":false,"No Issue":true,"Not Started ":true,"Problematic":true},
{"id":85,"Country":"Czech Republic","Patient Count":64,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":86,"Country":"France","Patient Count":63,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":87,"Country":"China","Patient Count":12,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":88,"Country":"Philippines","Patient Count":97,"Out of Scope":true,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":89,"Country":"Indonesia","Patient Count":69,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":90,"Country":"France","Patient Count":67,"Out of Scope":false,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":91,"Country":"Greece","Patient Count":2,"Out of Scope":true,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":92,"Country":"Portugal","Patient Count":4,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":false},
{"id":93,"Country":"Russia","Patient Count":63,"Out of Scope":true,"No Issue":true,"Not Started ":true,"Problematic":true},
{"id":94,"Country":"Czech Republic","Patient Count":48,"Out of Scope":true,"No Issue":true,"Not Started ":true,"Problematic":true},
{"id":95,"Country":"China","Patient Count":96,"Out of Scope":true,"No Issue":true,"Not Started ":false,"Problematic":false},
{"id":96,"Country":"China","Patient Count":16,"Out of Scope":false,"No Issue":false,"Not Started ":false,"Problematic":true},
{"id":97,"Country":"Indonesia","Patient Count":76,"Out of Scope":true,"No Issue":false,"Not Started ":true,"Problematic":true},
{"id":98,"Country":"China","Patient Count":16,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":false},
{"id":99,"Country":"United States","Patient Count":39,"Out of Scope":true,"No Issue":true,"Not Started ":true,"Problematic":false},
{"id":100,"Country":"Cyprus","Patient Count":100,"Out of Scope":false,"No Issue":false,"Not Started ":true,"Problematic":true}]

// Create MapChart instance
var map = am4core.create("chartdiv", am4maps.MapChart);

//Set map definition
map.geodata = am4geodata_worldLow;

//Set projection
map.projection = new am4maps.projections.Miller();

//Create map polygon series
var polygonSeries = map.series.push(new am4maps.MapPolygonSeries());

//Make map load polygon (like country names) data from GeoJSON
polygonSeries.useGeodata = true;

// Configure series
var polygonTemplate = polygonSeries.mapPolygons.template;
polygonTemplate.tooltipText = "{name}";
polygonTemplate.fill = am4core.color("#12769E");

// Create hover state and set alternative fill color
var hs = polygonTemplate.states.create("hover");
hs.properties.fill = am4core.color("#FFFFFF");

//Exclude Antarctica
polygonSeries.exclude = ["AQ"];

//Zoom control (VERY customizable)
map.zoomControl = new am4maps.ZoomControl();

/*
Data - How to import data from something like Excel??? Use a JSON maybe???
Have to manually set each country value ))):
HOWEVER you can use heat-map settings to change the colors instead of manually setting
the color for each country.
*/
polygonSeries.data = [{
  "id": "US",
  "name": "United States",
  "value": 100,
  "fill": am4core.color("#FF671F")
}, {
  "id": "ES",
  "name": "Spain",
  "value": 50,
  "fill": am4core.color("#EB3300")
}, {
  "id": "SA",
  "name": "Saudi Arabia",
  "value": 50,
  "fill": am4core.color("#FF671F")
}, {
  "id": "OM",
  "name": "Oman",
  "value": 50,
  "fill": am4core.color("#FF671F")
}, {
  "id": "NE",
  "name": "Niger",
  "value": 50,
  "fill": am4core.color("#EB3300")
}, {
  "id": "GL",
  "name": "Greenland",
  "value": 50,
  "fill": am4core.color("#828D95")
}, {
  "id": "ET",
  "name": "Ethiopia",
  "value": 50,
  "fill": am4core.color("#BBBCBC")
}, {
  "id": "KE",
  "name": "Kenya",
  "value": 50,
  "fill": am4core.color("#BBBCBC")
}];

data.forEach(element => {
  if (element["Country"] == "China") {
    polygonSeries.data.push({"id" : "CN", "name": "China", "value":50, "fill":am4core.color("#BBBCBC")});
  }
});

// Bind "fill" property to "fill" key in data
polygonTemplate.propertyFields.fill = "fill";

// Create image series
var imageSeries = map.series.push(new am4maps.MapImageSeries());

// Create a circle image in image series template so it gets replicated to all new images
// How to dynamically change size of circle depending on data (no copies)?
var imageSeriesTemplate = imageSeries.mapImages.template;
var circle = imageSeriesTemplate.createChild(am4core.Circle);
circle.radius = 8;
circle.fillOpacity = 0;
circle.stroke = am4core.color("#FFFFFF");
circle.strokeWidth = 2;
circle.nonScaling = true;
circle.tooltipText = "{title}";

// Set property fields
imageSeriesTemplate.propertyFields.latitude = "latitude";
imageSeriesTemplate.propertyFields.longitude = "longitude";

// Add data for the three cities
imageSeries.data = [{
  "latitude": 48.856614,
  "longitude": 2.352222,
  "title": "Paris"
}, {
  "latitude": 40.712775,
  "longitude": -74.005973,
  "title": "New York"
}, {
  "latitude": 49.282729,
  "longitude": -123.120738,
  "title": "Vancouver"
}, {
  "latitude": 39.09973,
  "longitude": -94.57857,
  "title": "Kansas City"
}];

map.backgroundSeries.mapPolygons.template.polygon.fill = am4core.color("#293B56");
map.backgroundSeries.mapPolygons.template.polygon.fillOpacity = 2;


// Create XYchart instance
var chart = am4core.create("am-chart", am4charts.XYChart);


//var container = am4core.create("am-chart", am4core.Container);
chart.width = am4core.percent(25);
chart.height = am4core.percent(100);
chart.background.fill = am4core.color("#293b56");
chart.background.fillOpacity = 0;
chart.background.stroke = am4core.color("#293b56");
chart.background.strokeOpacity = 2;
chart.background.strokeWidth = 2;
chart.marginRight = 400;


//chart.parent = container;

// Add data
chart.data = [{
  "topic": "",
  "total": 501,
  "spent": 450,
}];

// Add and configure Series
var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
categoryAxis.dataFields.category = "topic";
categoryAxis.title.text = "Patient Enrollment";
categoryAxis.title.strokeWidth = 1;
categoryAxis.fontSize = 22;
categoryAxis.fill = "#ffffff";
categoryAxis.renderer.grid.template.location = 0;
categoryAxis.renderer.minGridDistance = 20;
categoryAxis.renderer.grid.template.disabled = true;

var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
valueAxis.renderer.labels.template.disabled = true;
valueAxis.renderer.grid.template.disabled = true;


// Create series

var series = chart.series.push(new am4charts.ColumnSeries());
series.dataFields.valueY = "total";
series.dataFields.categoryX = "topic";
series.clustered = false;
series.name = "Total";
series.tooltipText = "{name}: [bold]{valueY}[/]";

var series2 = chart.series.push(new am4charts.ColumnSeries());
series2.dataFields.valueY = "spent";
series2.dataFields.categoryX = "topic";
series2.clustered = false;
series2.name = "Spent";
series2.tooltipText = "{name}: [bold]{valueY}[/]";


// Add cursor
chart.cursor = new am4charts.XYCursor();
chart.cursor.lineX.disabled = true;
chart.cursor.lineY.disabled = true;





// Left horizontal bar charts

am4core.ready(function () {

  // Themes begin
  am4core.useTheme(am4themes_animated);
  // Themes end

  var kpiamChart = am4core.create("kpiamChart", am4charts.XYChart);
  kpiamChart.hiddenState.properties.opacity = 0; // this creates initial fade-in
  kpiamChart.colors.list = [
    // light blue, orange, dark blue
    am4core.color("#75BDD0"),
    am4core.color("#F15A2A"),
    am4core.color("#4D5B74"),
    am4core.color("#ffffff")

  ];


 

  kpiamChart.data = [


    {
      category: "PATIENTS ENROLLED",
      value0: 14,
      // value2: 5,
      value2: 200 - 14
    },
    {
      category: "SITES ACTIVATED",
      value0: 48,
      // value2: 0,
      value2: 200 - 48
    },
    {
      category: "SITES IDENTIFIED",
      value0: 68,
      value1: 40,
      value2: 200 - 68 - 40
    },

  ];

  // chart.colors.step = 2;
  kpiamChart.padding(30, 10, 10, 0);
  kpiamChart.legend = new am4charts.Legend();


  var categoryAxis = kpiamChart.yAxes.push(new am4charts.CategoryAxis());

  categoryAxis.dataFields.category = "category";
  categoryAxis.renderer.dy = -30;
  // categoryAxis.renderer.dx = 100;
  categoryAxis.renderer.grid.template.location = 0;

  // resize cell which changes column size
  categoryAxis.renderer.cellStartLocation = 0.1;
  categoryAxis.renderer.cellEndLocation = 0.3;

  // remove grid
  categoryAxis.renderer.grid.template.disabled = true;

  var valueAxis = kpiamChart.xAxes.push(new am4charts.ValueAxis());
  valueAxis.min = 0;
  valueAxis.max = 100;
  valueAxis.strictMinMax = true;
  valueAxis.calculateTotals = true;
  valueAxis.renderer.minWidth = 50;

  var series = [];
  var bullets = [];
  var numSeries = 3;
  for (i = 0; i < numSeries; i++) {
    series.push(kpiamChart.series.push(new am4charts.ColumnSeries()));
    series[i].columns.template.width = am4core.percent(50);

    series[i].columns.template.tooltipText =
      "{name}: {valueX.totalPercent.formatNumber('#.00')}%";
    // series[i].name = "Series ".concat(i);
    if (i == 0) {
      series[i].name = "Completed";
    } else if (i == 1) {
      series[i].name = "At Risk";
    } else if (i == 2) {
      series[i].name = "To Be Completed";
    }

    series[i].dataFields.categoryY = "category";
    series[i].dataFields.valueX = "value".concat(i);
    series[i].dataFields.valueXShow = "totalPercent";
    series[i].dataItems.template.locations.categoryY = 0.5;

    series[i].stacked = true;
    series[i].tooltip.pointerOrientation = "horizontal";

    var fillModifier = new am4core.LinearGradientModifier();
    fillModifier.opacities = [1, 1];
    fillModifier.brightnesses = [.3, 1];
    fillModifier.lightnesses = [.5, 0];

    fillModifier.offsets = [0, 1];

    series[i].columns.template.fillModifier = fillModifier;

    bullets[i] = series[i].bullets.push(new am4charts.LabelBullet());
    bullets[i].interactionsEnabled = false;
    bullets[i].label.text = "{valueX.totalPercent.formatNumber('#.00')}%";
    bullets[i].label.fill = am4core.color("#ffffff");

    bullets[i].locationX = 0.5;


  }
  // categoryAxis.renderer.disabled = true;
  categoryAxis.renderer.inside = true;

  valueAxis.renderer.labels.template.disabled = true;
  categoryAxis.position = "left";
  // kpiamChart.scrollbarY = new am4core.Scrollbar();

}); // end am4core.ready()
